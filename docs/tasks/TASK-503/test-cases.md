# TASK-503: 履歴一覧・詳細画面実装 - テストケース

## テスト対象コンポーネント

- `HistoryListScreen` - 履歴一覧画面
- `HistoryDetailScreen` - 詳細表示画面
- `HistoryFilter` - 検索・フィルター
- `HistoryCard` - 記録カード
- `WaypointList` - ウェイポイント一覧
- `useHistoryList` - 一覧管理フック
- `useHistoryDetail` - 詳細管理フック

## テストケース一覧 (総計: 55件)

### 1. HistoryListScreen コンポーネント (15件)

#### 基本表示テスト
- **TC-001**: 履歴一覧画面が正常にレンダリングされる
- **TC-002**: プロパティ（className）が正しく適用される
- **TC-003**: 記録データが存在する場合、カード形式で表示される
- **TC-004**: 記録データが存在しない場合、空状態メッセージが表示される
- **TC-005**: ローディング中はスケルトンスクリーンが表示される

#### 一覧表示機能テスト
- **TC-006**: 20件ずつのページネーションが正しく動作する
- **TC-007**: 無限スクロールで追加データが読み込まれる
- **TC-008**: 記録カードに必要な情報（日時、地点、時間、距離、ステータス）が表示される
- **TC-009**: 記録ステータスが色分けして表示される
- **TC-010**: 記録カードクリックで詳細画面に遷移する

#### フィルター・検索テスト
- **TC-011**: 検索・フィルター機能が表示される
- **TC-012**: フィルター適用時に結果が更新される
- **TC-013**: フィルターリセット機能が動作する
- **TC-014**: 複数フィルター組み合わせが正しく動作する
- **TC-015**: 検索結果0件時に適切なメッセージが表示される

### 2. HistoryDetailScreen コンポーネント (12件)

#### 基本表示テスト
- **TC-016**: 詳細画面が正常にレンダリングされる
- **TC-017**: 記録IDに対応する詳細データが表示される
- **TC-018**: 戻るボタンが正しく動作する
- **TC-019**: 記録が存在しない場合エラーメッセージが表示される

#### 詳細情報表示テスト
- **TC-020**: 記録概要（日時、地点、時間、距離）が正確に表示される
- **TC-021**: 記録統計（平均速度、最高速度、停止時間）が表示される
- **TC-022**: GPS精度情報が表示される
- **TC-023**: ウェイポイント一覧が時系列順で表示される

#### 操作機能テスト
- **TC-024**: 編集ボタンクリックで編集モードに切り替わる
- **TC-025**: 削除ボタンクリックで確認ダイアログが表示される
- **TC-026**: 削除確認で記録が削除される
- **TC-027**: エクスポートボタンで個別エクスポートが実行される

### 3. HistoryFilter コンポーネント (10件)

#### 日付フィルターテスト
- **TC-028**: 日付範囲フィルターが正しく動作する
- **TC-029**: 開始日のみ設定時に正しくフィルタリングされる
- **TC-030**: 終了日のみ設定時に正しくフィルタリングされる
- **TC-031**: 無効な日付範囲でエラー表示される

#### 検索・その他フィルターテスト
- **TC-032**: 地点名検索が部分一致で動作する
- **TC-033**: ステータスフィルターが正しく動作する
- **TC-034**: 距離範囲フィルターが正しく動作する
- **TC-035**: 時間範囲フィルターが正しく動作する
- **TC-036**: フィルター組み合わせが AND 条件で動作する
- **TC-037**: フィルターリセットで全条件がクリアされる

### 4. HistoryCard コンポーネント (8件)

#### 表示テスト
- **TC-038**: 記録カードが正しくレンダリングされる
- **TC-039**: 記録情報が正確に表示される（日時、地点、時間、距離）
- **TC-040**: ステータスが適切な色・アイコンで表示される
- **TC-041**: 進行中の記録に進行中バッジが表示される

#### インタラクションテスト
- **TC-042**: カードクリックで onRecordSelect が呼ばれる
- **TC-043**: 編集ボタンクリックで onEdit が呼ばれる
- **TC-044**: 削除ボタンクリックで onDelete が呼ばれる
- **TC-045**: タッチ操作で適切なフィードバックが表示される

### 5. WaypointList コンポーネント (5件)

#### 表示テスト
- **TC-046**: ウェイポイント一覧が時系列順で表示される
- **TC-047**: 各ウェイポイントに適切なアイコンが表示される
- **TC-048**: GPS精度が色分けして表示される

#### 編集テスト
- **TC-049**: 編集可能モードで地点名編集ができる
- **TC-050**: 地点名変更時に onEditWaypoint が呼ばれる

### 6. useHistoryList フック (8件)

#### 状態管理テスト
- **TC-051**: 初期状態が正しく設定される
- **TC-052**: 履歴データ取得時に状態が更新される
- **TC-053**: ローディング状態が正しく管理される
- **TC-054**: エラー状態が正しく管理される

#### 機能テスト
- **TC-055**: フィルター変更時にデータが再取得される
- **TC-056**: ページネーション機能が正しく動作する
- **TC-057**: 並び替え機能が正しく動作する
- **TC-058**: 記録削除時に一覧から除外される

### 7. useHistoryDetail フック (5件)

#### 状態管理テスト
- **TC-059**: 詳細データ取得時に状態が更新される
- **TC-060**: ローディング・エラー状態が正しく管理される

#### 機能テスト
- **TC-061**: 記録編集時に状態が更新される
- **TC-062**: ウェイポイント編集機能が動作する
- **TC-063**: 記録削除機能が動作する

## アクセシビリティテスト (7件)

### セマンティックHTML
- **AC-001**: 適切な見出し構造（h1, h2, h3）が使用されている
- **AC-002**: リスト構造（ul, li）が適切に使用されている
- **AC-003**: ボタン要素が適切に使用されている

### ARIA属性
- **AC-004**: リスト領域に aria-label が設定されている
- **AC-005**: 検索フィールドに aria-describedby が設定されている
- **AC-006**: ステータス表示に aria-live が設定されている

### キーボードナビゲーション
- **AC-007**: 全ての操作要素がキーボードでアクセス可能

## レスポンシブデザインテスト (8件)

### モバイル（～480px）
- **RD-001**: モバイルレイアウトが適切に表示される
- **RD-002**: タッチ操作に適したボタンサイズ（44px以上）
- **RD-003**: フィルターが展開・折りたたみ可能

### タブレット（481px～768px）
- **RD-004**: タブレットレイアウトが適切に表示される
- **RD-005**: 2カラムグリッド表示が正しく動作する

### デスクトップ（769px以上）
- **RD-006**: デスクトップレイアウトが適切に表示される
- **RD-007**: サイドバーフィルターが固定表示される
- **RD-008**: 3カラムグリッド表示が正しく動作する

## パフォーマンステスト (6件)

### 表示速度
- **PF-001**: 初期表示が2秒以内に完了する
- **PF-002**: フィルター適用が1秒以内に完了する
- **PF-003**: ページネーション読み込みが1秒以内に完了する

### スクロール性能
- **PF-004**: 仮想スクロールが60FPSで動作する
- **PF-005**: 大量データ（1000件）表示でも快適に動作する

### メモリ効率
- **PF-006**: 長時間使用でもメモリリークが発生しない

## エラーハンドリングテスト (5件)

### データ取得エラー
- **EH-001**: ネットワークエラー時に再試行ボタンが表示される
- **EH-002**: サーバーエラー時に適切なエラーメッセージが表示される

### 操作エラー
- **EH-003**: 無効なフィルター条件でエラーメッセージが表示される
- **EH-004**: 削除失敗時にエラー通知が表示される
- **EH-005**: 編集失敗時に元の状態に復元される

## 統合テスト (6件)

### ユーザーフロー
- **IT-001**: 一覧表示→フィルター→詳細表示の完全フロー
- **IT-002**: 検索→絞り込み→詳細表示→編集→保存のフロー
- **IT-003**: 記録選択→削除→確認→一覧更新のフロー

### データ連携
- **IT-004**: HistoryController との連携が正しく動作する
- **IT-005**: LocationController との連携が正しく動作する
- **IT-006**: ExportController との連携が正しく動作する

## テスト実行環境

### ブラウザ
- Chrome (最新版)
- Firefox (最新版)
- Safari (最新版)
- Edge (最新版)

### デバイス
- iPhone (iOS最新版)
- Android (最新版)
- iPad (最新版)
- Windows/Mac デスクトップ

### テストツール
- Jest + React Testing Library (単体テスト)
- MSW (API モック)
- Playwright (E2Eテスト)
- axe-core (アクセシビリティテスト)

## 合格基準

### 機能テスト
- 全テストケースの95%以上が合格
- クリティカルなエラーが0件
- 重要機能の100%動作確認

### パフォーマンス
- 初期表示2秒以内
- フィルター応答1秒以内
- スクロール60FPS維持

### アクセシビリティ
- WCAG 2.1 AA準拠
- axe-core での違反0件
- キーボード操作100%対応

### レスポンシブ
- 各画面サイズで正常表示
- タッチ操作の快適性確保
- レイアウト崩れ0件